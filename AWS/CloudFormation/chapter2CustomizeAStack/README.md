# AWS CloudFormation  

overview -------------      
creating a template from scratch    -         
anatomy of a template    -         
define target state of your infrastructure    -         
explore resource types and their properties    -         
describe dependencies between resources    -         
    -         



////////////////////////////////////////////////////////////////////   
SSH Bastion Host    -         
    -         
needed parts for Bastion Host    -         
1 ec2 instance // running a SSH server    -         
2 elastic IP // Static and public IP address linked to EC2 instance    -         
3 security group // firewall rules controlling incoming traffic to EC2 instance    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
////////////////////////////////////////////////////////////////////   
anatomy of a cloudformation template    -         
    -         
1 aws templateformationVersion    -         
2 description    -         
3 Resouces    -         
```
{
     "Resources": {
          "EC2Instance": {...},
          "ElasticIP": {...},
          "SecurityGroup": {...}
     }
}

```       
    -         
resource types   

```
ec2
rds
dynamoDB


{
     "Resources": {
          "EC2Instance": {
               "Type": "AWS::EC2::Instance",
               "Properties": {
                    "ImageId":"ami-bff32ccc",
                    "InstanceType": "t2.nano",
                    "NetworkInterfaces":[{"SubnetId":"..."}]
                    ...}
          },
          "ElasticIP": {
               "Type": "AWS::EC2::EIP",
               "Properties": {
                    "InstanceId":"i-d0f2e055",
                    "Domain":"vpc"
                    ...}               

          },
          "SecurityGroup": {
               "Type": "AWS::EC2::SecurityGroup",
               "Properties": {
                    "GroupDescription":"ssh-bastion-host",
                    "VpcId":"vpc-6b53320e",
                    "SecurityGroupIngress":[{  // linked to VPC and nested ingress rules
                         "CidrIp":"0.0.0.0/0",
                         "FromPort": 22,
                         "IpProtocol": "tcp",
                         "ToPort":22
                         }] 
                    ...}               

          },          

     }



}


```         
    -         
    -         
    -         
    -         
    -         
    -       
////////////////////////////////////////////////////////////////////   
dependencies between resources    -         
```
"EC2Instance": {                                          //!
     "Properties": {
          "NetworkInterfaces":[{
               "GroupSet":[{"Ref":"SecurityGroup"}]       //!!     
               }]
     }
},

"SecurityGroup":{...}                                     //!!

"ElasticIP": {
     "Type": "AWS::EC2::EIP",
     "Properties": {
          "InstanceId": {"Ref":"EC2Instance"},            //!!
          "Domain":"vpc"
     }
}

```    
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
////////////////////////////////////////////////////////////////////   
create stack out of templat by using command line interface(CLI)    -         

1 install aws cli(https://aws.amazon.com/cli/)    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -           
////////////////////////////////////////////////////////////////////   
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
////////////////////////////////////////////////////////////////////   
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -       
////////////////////////////////////////////////////////////////////   
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
////////////////////////////////////////////////////////////////////   
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -           
////////////////////////////////////////////////////////////////////   
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
////////////////////////////////////////////////////////////////////   
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -       
////////////////////////////////////////////////////////////////////   
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
////////////////////////////////////////////////////////////////////   
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -           
////////////////////////////////////////////////////////////////////   
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
////////////////////////////////////////////////////////////////////   
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -       
////////////////////////////////////////////////////////////////////   
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
////////////////////////////////////////////////////////////////////   
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -           
////////////////////////////////////////////////////////////////////   
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
////////////////////////////////////////////////////////////////////   
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -       
////////////////////////////////////////////////////////////////////   
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
////////////////////////////////////////////////////////////////////   
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -           
////////////////////////////////////////////////////////////////////   
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
////////////////////////////////////////////////////////////////////   
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -       
////////////////////////////////////////////////////////////////////   
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
////////////////////////////////////////////////////////////////////   
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -           
////////////////////////////////////////////////////////////////////   
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
////////////////////////////////////////////////////////////////////   
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -       
////////////////////////////////////////////////////////////////////   
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
////////////////////////////////////////////////////////////////////   
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -           
////////////////////////////////////////////////////////////////////   
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
////////////////////////////////////////////////////////////////////   
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -       
////////////////////////////////////////////////////////////////////   
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
////////////////////////////////////////////////////////////////////   
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -           
////////////////////////////////////////////////////////////////////   
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
////////////////////////////////////////////////////////////////////   
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -       
////////////////////////////////////////////////////////////////////   
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
////////////////////////////////////////////////////////////////////   
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -         
    -           
